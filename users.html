<h1 id="users">Users</h1>
<p>Sproute comes with User Accounts straight out-of-the-box. To make use of them you should create some <a href="/docs/pages">pages</a> to send requests to the following end-points.</p>
<h2 id="endpoints">Endpoints</h2>
<h3 id="post-apilogin">POST /api/login</h3>
<ul>
<li><code>name</code>: Username of the account.</li>
<li><code>pass</code>: Password of the account.</li>
</ul>
<p>Create a session on the server for a user. If they are already logged in, an error will be returned.</p>
<h3 id="get-apilogout">GET /api/logout</h3>
<p>Sending a GET request to this URL will logout the currently logged in user. This is as simple as creating an anchor in HTML.</p>
<pre><code>&lt;a href=&quot;/api/logout?goto=/&quot;&gt;Logout&lt;/a&gt;</code></pre>
<h3 id="post-apiregister">POST /api/register</h3>
<ul>
<li><code>email</code>: Email address.</li>
<li><code>name</code>: Username.</li>
<li><code>pass</code>: Password.</li>
<li><code>role</code>: Role; defaults to <code>member</code>.</li>
</ul>
<p>Use this end-point over <code>/data/users</code>. Will create a new user with the data provided. If you have extended the user model, include the data in the body.</p>
<p>When specifying a role, you will only be allowed to use the lowest role (<code>member</code>). If you are logged in when creating a user, you can set the role to your level or lower. So if you are logged in as <code>admin</code>, you can set the role to <code>admin</code> or lower.</p>
<h3 id="get-apilogged">GET /api/logged</h3>
<p>Returns the object of the user logged or <code>false</code> if not logged in. Add the query parameter <code>?reload=true</code> to query the database if the user row has been updated.</p>
<h3 id="post-apiupdate">POST /api/update</h3>
<ul>
<li><code>pass</code>: User's current password.</li>
<li><code>newpass</code>: Optional if updating user's password.</li>
</ul>
<p>Allow a user to update their password and other associated data. Must include their current password for security.</p>
<p><em>Note: Updating the password through the HTTP interface will not correctly encrypt it.</em></p>
<h3 id="post-apiforgot">POST /api/forgot</h3>
<ul>
<li><code>name</code>: User name of the forgotten account password.</li>
</ul>
<p>Send a recovery email to the <code>name</code> field assuming a valid email address. This will include a unique link valid for 2 hours. The link will take them to a special URL, <code>/api/recover</code> and will render any page named <code>recover</code> with the variable <code>newpass</code>.</p>
<h2 id="session-storage">Session Storage</h2>
<p>The session is persisted through a cookie with <code>maxage</code> set to 0 or forever. This can only be destroyed through <code>/api/logout</code>.</p>
